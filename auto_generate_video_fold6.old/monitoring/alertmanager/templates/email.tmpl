{{ define "email.default.subject" }}
[{{ .Status | title }}] {{ .GroupLabels.alertname }} ({{ .Alerts | len }} alert{{ if gt (len .Alerts) 1 }}s{{ end }})
{{ end }}

{{ define "email.default.html" }}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .header { background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .alert { margin: 10px 0; padding: 15px; border-radius: 5px; }
        .critical { background: #ffe6e6; border-left: 4px solid #d73527; }
        .warning { background: #fff3cd; border-left: 4px solid #ffc107; }
        .resolved { background: #d4edda; border-left: 4px solid #28a745; }
        .info { background: #d1ecf1; border-left: 4px solid #17a2b8; }
        .footer { margin-top: 20px; padding-top: 20px; border-top: 1px solid #dee2e6; }
        .label { font-weight: bold; }
        .value { margin-left: 10px; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h2>ðŸš¨ Auto Video System Alert</h2>
        <p><strong>Status:</strong> {{ .Status | title }}</p>
        <p><strong>Group:</strong> {{ .GroupLabels.alertname }}</p>
        <p><strong>Time:</strong> {{ .CommonAnnotations.timestamp | default "N/A" }}</p>
    </div>

    {{ if eq .Status "firing" }}
        <h3>ðŸ”¥ Active Alerts ({{ .Alerts.Firing | len }})</h3>
        {{ range .Alerts.Firing }}
        <div class="alert {{ if eq .Labels.severity "critical" }}critical{{ else if eq .Labels.severity "warning" }}warning{{ else }}info{{ end }}">
            <h4>{{ .Annotations.summary | default .Labels.alertname }}</h4>
            <p><strong>Description:</strong> {{ .Annotations.description | default "No description available" }}</p>
            
            <table>
                <tr><th>Label</th><th>Value</th></tr>
                {{ range .Labels.SortedPairs }}
                <tr><td>{{ .Name }}</td><td>{{ .Value }}</td></tr>
                {{ end }}
            </table>
            
            {{ if .Annotations }}
            <h5>Annotations:</h5>
            <table>
                {{ range .Annotations.SortedPairs }}
                <tr><td>{{ .Name }}</td><td>{{ .Value }}</td></tr>
                {{ end }}
            </table>
            {{ end }}
            
            <p><strong>Started:</strong> {{ .StartsAt }}</p>
        </div>
        {{ end }}
    {{ end }}

    {{ if .Alerts.Resolved }}
        <h3>âœ… Resolved Alerts ({{ .Alerts.Resolved | len }})</h3>
        {{ range .Alerts.Resolved }}
        <div class="alert resolved">
            <h4>{{ .Annotations.summary | default .Labels.alertname }}</h4>
            <p><strong>Description:</strong> {{ .Annotations.description | default "No description available" }}</p>
            <p><strong>Started:</strong> {{ .StartsAt }}</p>
            <p><strong>Ended:</strong> {{ .EndsAt }}</p>
        </div>
        {{ end }}
    {{ end }}

    <div class="footer">
        <p><strong>Prometheus:</strong> <a href="{{ .ExternalURL }}">View in Prometheus</a></p>
        <p><strong>Generated:</strong> {{ now }}</p>
        <p><em>Auto Video System Monitoring</em></p>
    </div>
</body>
</html>
{{ end }}

{{ define "slack.default.title" }}
{{ if eq .Status "firing" }}ðŸš¨{{ else }}âœ…{{ end }} {{ .GroupLabels.alertname }}
{{ end }}

{{ define "slack.default.text" }}
{{ if eq .Status "firing" }}
ðŸ”¥ **Active Alerts:** {{ .Alerts.Firing | len }}
{{ range .Alerts.Firing }}
**{{ .Annotations.summary | default .Labels.alertname }}**
{{ .Annotations.description | default "No description available" }}
Service: {{ .Labels.service | default "unknown" }}
Severity: {{ .Labels.severity | default "unknown" }}
{{ end }}
{{ else }}
âœ… **Resolved Alerts:** {{ .Alerts.Resolved | len }}
{{ range .Alerts.Resolved }}
**{{ .Annotations.summary | default .Labels.alertname }}**
Duration: {{ .StartsAt }} - {{ .EndsAt }}
{{ end }}
{{ end }}
{{ end }}

{{ define "webhook.default.json" }}
{
  "status": "{{ .Status }}",
  "groupLabels": {{ .GroupLabels | toJson }},
  "commonLabels": {{ .CommonLabels | toJson }},
  "commonAnnotations": {{ .CommonAnnotations | toJson }},
  "externalURL": "{{ .ExternalURL }}",
  "alerts": [
    {{ range $i, $alert := .Alerts }}
    {{ if $i }},{{ end }}
    {
      "status": "{{ $alert.Status }}",
      "labels": {{ $alert.Labels | toJson }},
      "annotations": {{ $alert.Annotations | toJson }},
      "startsAt": "{{ $alert.StartsAt }}",
      "endsAt": "{{ $alert.EndsAt }}",
      "generatorURL": "{{ $alert.GeneratorURL }}",
      "fingerprint": "{{ $alert.Fingerprint }}"
    }
    {{ end }}
  ]
}
{{ end }}